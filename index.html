<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mr Presentation | مستر بريزنتيشن — قوالب وعروض + توليد PPT</title>

  <!-- Meta أساسية -->
  <meta name="description" content="مستر بريزنتيشن — قوالب بوربوينت جاهزة وتصميم عروض احترافية للخليج والسعودية ومصر. حوّل نصك إلى عرض بوربوينت تلقائيًا على الموقع." />
  <meta property="og:title" content="Mr Presentation - مستر بريزنتيشن | قوالب + 3D + توليد عروض" />
  <meta property="og:description" content="اكتب نصك وحمّل عرضك فورًا. قوالب جاهزة وتصميمات مخصصة." />
  <meta property="og:image" content="logo.png" />

  <!-- Fonts + Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- 3D viewer -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <style>
    html, body {width:100%; overflow-x:hidden; scroll-behavior:smooth;}
    body{
      font-family:'Cairo',system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;
      color:#e5e7eb;
      background:#0b1220 url('tech-bg.gif') center/cover fixed no-repeat;
    }
    :root{--vio:#7c3aed; --cyan:#22d3ee; --gold:#f59e0b; --glass:rgba(255,255,255,.06);}

    header.nav{position:sticky; top:0; z-index:20; backdrop-filter:saturate(140%) blur(10px);
      background:linear-gradient(135deg, rgba(124,58,237,.22), rgba(34,211,238,.12)); border-bottom:1px solid rgba(255,255,255,.06)}
    .container{max-width:72rem; margin-inline:auto; padding-inline:1rem}
    .title-grad{background:linear-gradient(45deg, #a78bfa, #22d3ee, #f59e0b); -webkit-background-clip:text; background-clip:text; color:transparent}
    .card{border:1px solid rgba(255,255,255,.08); background:var(--glass); border-radius:1rem; transition:.18s ease}
    .btn{border-radius:.9rem; padding:.75rem 1rem; font-weight:700; transition:.18s ease; cursor:pointer}
    .btn-primary{background:linear-gradient(135deg, var(--vio), var(--cyan)); color:#fff}
    .btn-ghost{background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12); color:#fff}
    .hover-scale:hover{transform:scale(1.03); box-shadow:0 10px 24px rgba(0,0,0,.35)}
    footer{border-top:1px solid rgba(255,255,255,.08); background:rgba(0,0,0,.4)}

    /* social */
    .social{display:inline-flex; align-items:center; justify-content:center; width:36px; height:36px; border-radius:10px;
      background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12); transition:.18s ease}
    .social:hover{transform:scale(1.07); box-shadow:0 8px 18px rgba(0,0,0,.35)}

    /* Intro */
    #intro{position:fixed; inset:0; z-index:50; display:flex; align-items:center; justify-content:center; overflow:hidden;
      background:radial-gradient(1200px 800px at 50% 50%, rgba(124,58,237,.14), transparent 60%),
                 linear-gradient(180deg, rgba(11,18,32,.96), rgba(11,18,32,.98));}
    #intro .halo{position:absolute; width:150vmax; height:150vmax; background:
      radial-gradient(closest-side, rgba(124,58,237,.18), transparent 65%),
      radial-gradient(farthest-corner at 20% 80%, rgba(34,211,238,.16), transparent 60%);
      animation:spin 16s linear infinite; opacity:.85}
    #intro .grid{position:absolute; inset:0; background-image:
      linear-gradient(90deg, rgba(255,255,255,.05) 1px, transparent 1px),
      linear-gradient(0deg,  rgba(255,255,255,.05) 1px, transparent 1px);
      background-size:100px 100px; opacity:.12}
    @keyframes spin{to{transform:rotate(360deg)}}
    .intro-content{position:relative; z-index:2; text-align:center}
    .intro-logo{width:min(36vmin, 280px); height:min(36vmin, 280px); border-radius:9999px; overflow:hidden;
      border:3px solid rgba(255,255,255,.2); box-shadow:0 0 0 12px rgba(124,58,237,.12), 0 28px 80px rgba(0,0,0,.55);
      transform:scale(.85); opacity:0; animation:pop .9s cubic-bezier(.2,.9,.2,1) .25s forwards}
    @keyframes pop{to{transform:scale(1); opacity:1;}}
    .intro-top{position:absolute; top:clamp(12px,4vmin,28px); right:clamp(12px,4vmin,28px);
      font-weight:900; font-size:clamp(36px, 8vmin, 80px);
      background:linear-gradient(45deg,#fff,#a7f3d0,#22d3ee); -webkit-background-clip:text; color:transparent;
      transform:translateY(-10px); opacity:0; animation:slideIn .9s ease .35s forwards}
    .intro-bottom{position:absolute; bottom:clamp(12px,4vmin,28px); left:clamp(12px,4vmin,28px);
      font-weight:900; font-size:clamp(36px, 8vmin, 80px);
      background:linear-gradient(45deg,#fff,#fcd34d,#a78bfa); -webkit-background-clip:text; color:transparent;
      transform:translateY(10px); opacity:0; animation:slideIn .9s ease .55s forwards}
    @keyframes slideIn{to{transform:translateY(0); opacity:1;}}
    .intro-skip{position:absolute; top:18px; left:18px; font-size:12px; padding:.45rem .7rem; border-radius:.6rem;
      background:rgba(255,255,255,.1); border:1px solid rgba(255,255,255,.16); backdrop-filter:blur(6px)}
    .intro-fade{animation:fadeOut .65s ease forwards}
    @keyframes fadeOut{to{opacity:0; visibility:hidden}}
  </style>
</head>
<body>

  <!-- Intro -->
  <div id="intro" aria-hidden="true">
    <div class="halo"></div>
    <div class="grid"></div>
    <button class="intro-skip" id="skipIntro">تخطي</button>
    <div class="intro-top">مستر</div>
    <div class="intro-bottom">بريزنتيشن</div>
    <div class="intro-content">
      <img src="logo.png" alt="Logo" class="intro-logo">
    </div>
  </div>

  <!-- Header -->
  <header class="nav">
    <div class="container py-3 flex items-center gap-3">
      <a href="#" class="flex items-center gap-2 hover-scale">
        <img src="logo.png" alt="Mr Presentation" class="h-9 w-9 rounded-full ring-2 ring-white/10" onerror="this.style.display='none'">
        <span class="font-extrabold text-lg">Mr Presentation</span>
      </a>
      <div class="flex items-center gap-2 ms-auto me-2">
        <a class="social" target="_blank" aria-label="TikTok"
           href="https://www.tiktok.com/@mr_presentation" title="TikTok">
          <svg width="18" height="18" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M41 16.2c-4.8-.6-8.5-3.2-10.3-7.2V33c0 6.7-5.5 12.1-12.3 12.1S6 39.7 6 33s5.5-12.1 12.3-12.1c1 0 2 .1 2.9.3v7A5.4 5.4 0 0 0 18.3 28c-3 0-5.5 2.4-5.5 5.4s2.5 5.4 5.5 5.4S24 36.4 24 33V2h6.7c1.6 5.2 5.7 9 10.9 10.2v4z" fill="currentColor"/>
          </svg>
        </a>
        <a class="social" target="_blank" aria-label="Instagram"
           href="https://www.instagram.com/mr_presentation.1" title="Instagram">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M7 2C4.243 2 2 4.243 2 7v10c0 2.757 2.243 5 5 5h10c2.757 0 5-2.243 5-5V7c0-2.757-2.243-5-5-5H7zm10 2a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10zm-5 3a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm6-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
          </svg>
        </a>
      </div>
    </div>
  </header>

  <main>
    <!-- Hero -->
    <section class="relative">
      <div class="container py-14 grid md:grid-cols-2 gap-10 items-center">
        <div>
          <h1 class="text-4xl md:text-5xl font-extrabold leading-tight">
            نسوّي لك <span class="title-grad">عرض بوربوينت يبيض الوجه</span> ويشد الانتباه
          </h1>
          <p class="mt-4 text-gray-200/90 text-lg">قوالب جاهزة + تصميم من الصفر. نخدم الخليج والسعودية ومصر — تصميم احترافي، إنفوجرافيك، وتسليم سريع.</p>
          <div class="mt-6 flex flex-wrap gap-3">
            <a href="#templates" class="btn btn-primary hover-scale">شوف القوالب</a>
            <a href="#pricing" class="btn btn-ghost hover-scale">الباقات</a>
          </div>
        </div>

        <div class="card p-3 hover-scale">
          <div class="aspect-[9/16] w-full rounded-xl overflow-hidden bg-black/60">
            <model-viewer src="robot.glb" autoplay animation-name="*" animation-loop auto-rotate auto-rotate-delay="0"
              camera-controls disable-tap exposure="1.1" shadow-intensity="0"
              style="width:100%; height:100%; background:transparent;">
            </model-viewer>
          </div>
          <p class="text-xs text-gray-300 mt-2">لو ما ظهر الروبوت، تأكد من وجود <b>robot.glb</b> جنب index.html.</p>
        </div>
      </div>
    </section>

    <!-- Templates -->
    <section id="templates" class="relative py-14">
      <div class="container">
        <h2 class="text-3xl font-extrabold mb-8">القوالب الجاهزة</h2>
        <div class="grid md:grid-cols-2 gap-6">
          <article class="card p-4 hover-scale">
            <div class="aspect-video rounded-lg overflow-hidden bg-black/60">
              <video class="template-video w-full h-full object-cover" autoplay muted loop playsinline controls data-template="Template 1">
                <source src="template1.mp4" type="video/mp4">
              </video>
            </div>
          </article>
          <article class="card p-4 hover-scale">
            <div class="aspect-video rounded-lg overflow-hidden bg-black/60">
              <video class="template-video w-full h-full object-cover" autoplay muted loop playsinline controls data-template="Template 2">
                <source src="template2.mp4" type="video/mp4">
              </video>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- Client Maker -->
    <section id="client-maker" class="relative py-14">
      <div class="container">
        <h2 class="text-3xl font-extrabold mb-6">حوّل نصك إلى بوربوينت تلقائيًا</h2>

        <div class="grid md:grid-cols-2 gap-6">
          <div class="card p-4">
            <label class="block mb-2 font-semibold">النص (عربي أو إنجليزي):</label>
            <textarea id="pptText" class="w-full h-56 rounded-md p-3 text-black" placeholder="اكتب أو الصق النص هنا.
افصل بين الشرائح بـ /// (اختياري)"></textarea>

            <div class="grid grid-cols-2 gap-4 mt-4">
              <div>
                <label class="block mb-2 font-semibold">عدد الشرائح (اختياري):</label>
                <input id="slideCount" type="number" min="1" class="w-full rounded-md p-2 text-black" placeholder="اتركه فاضي للتقسيم التلقائي" />
              </div>
              <div>
                <label class="block mb-2 font-semibold">التخصص/الموضوع:</label>
                <select id="topic" class="w-full rounded-md p-2 text-black">
                  <option value="cyber">Cyber Security</option>
                  <option value="marketing">Marketing</option>
                  <option value="cardio">Cardiology</option>
                  <option value="general">عام (بدون صور خاصة)</option>
                </select>
              </div>
            </div>

            <div class="grid grid-cols-2 gap-4 mt-4">
              <div>
                <label class="block mb-2 font-semibold">خلفية الشرائح:</label>
                <select id="bgStyle" class="w-full rounded-md p-2 text-black">
                  <option value="assets/bg-tech.jpg">خلفية تِك</option>
                  <option value="assets/bg-clean.jpg">خلفية بسيطة</option>
                  <option value="">بدون خلفية</option>
                </select>
              </div>
              <div>
                <label class="block mb-2 font-semibold">لغة النص:</label>
                <select id="lang" class="w-full rounded-md p-2 text-black">
                  <option value="auto">تلقائي</option>
                  <option value="ar">عربي (RTL)</option>
                  <option value="en">English (LTR)</option>
                </select>
              </div>
            </div>

            <button id="genBtn" class="btn btn-primary hover-scale mt-5">توليد ملف بوربوينت</button>
            <div id="genStatus" class="text-sm text-gray-200 mt-3"></div>
          </div>

          <div class="card p-4">
            <h3 class="font-bold text-lg mb-2">إرشادات سريعة</h3>
            <ul class="list-disc ps-6 text-sm text-gray-200">
              <li>افصل الشرائح بـ <b>///</b> لو عايز تحكّم يدوي.</li>
              <li>بدون فواصل: بنقسّم تلقائي حسب عدد الشرائح اللي تختاره.</li>
              <li>صورتين تلقائيًا لكل شريحة من فولدر الموضوع.</li>
              <li>ارفع صور الموضوع داخل <code>assets/[topic]/</code> بأسماء: <code>1.jpg</code>، <code>2.jpg</code>…</li>
              <li>غيّر الخلفية من القائمة فوق (ملفات داخل <code>assets/</code>).</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Pricing -->
    <section id="pricing" class="py-14">
      <div class="container">
        <h2 class="text-2xl sm:text-3xl font-extrabold mb-8">الباقات</h2>
        <div class="grid md:grid-cols-3 gap-6">
          <div class="card p-6 hover-scale">
            <h3 class="font-extrabold text-lg mb-2">Basic</h3>
            <p class="text-gray-200 mb-4">حتى 10 شرائح | تصميم أنيق بسيط</p>
            <div class="text-3xl font-extrabold mb-4">SAR <span>150</span></div>
            <div class="text-xs text-gray-300 mb-4">سعر الشريحة: 15 ريال</div>
            <a href="https://wa.me/201141965776?text=أرغب%20بباقة%20Basic" class="btn btn-ghost w-full hover-scale">اطلب الآن</a>
          </div>
          <div class="card p-6 hover-scale" style="border-color: rgba(245,158,11,.6); background: linear-gradient(135deg, rgba(124,58,237,.16), rgba(34,211,238,.12));">
            <div class="inline-flex items-center gap-2 px-2 py-1 rounded-lg bg-yellow-500/20 text-xs mb-3">الأكثر طلبًا</div>
            <h3 class="font-extrabold text-lg mb-2">Premium</h3>
            <p class="text-gray-100 mb-4">حتى 25 شريحة | إنفوجرافيك وانتقالات</p>
            <div class="text-3xl font-extrabold mb-1">SAR <span>375</span></div>
            <div class="text-xs text-gray-200 mb-4">سعر الشريحة: 15 ريال</div>
            <a href="https://wa.me/201141965776?text=أرغب%20بباقة%20Premium" class="btn btn-primary w-full hover-scale">احجز الآن</a>
          </div>
          <div class="card p-6 hover-scale">
            <h3 class="font-extrabold text-lg mb-2">VIP</h3>
            <p class="text-gray-200 mb-4">حتى 50 شريحة | كتابة نصوص + فيديو تصدير</p>
            <div class="text-3xl font-extrabold mb-1">SAR <span>750</span></div>
            <div class="text-xs text-gray-300 mb-4">سعر الشريحة: 15 ريال</div>
            <a href="https://wa.me/201141965776?text=أرغب%20بباقة%20VIP" class="btn btn-ghost w-full hover-scale">تواصل</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="py-10">
    <div class="container flex flex-col sm:flex-row items-center justify-between gap-4">
      <p class="text-sm text-gray-300">© <span id="y"></span> Mr Presentation (مستر بريزنتيشن). كل الحقوق محفوظة.</p>
      <div class="flex items-center gap-4 text-sm">
        <a href="https://wa.me/201141965776" class="hover-scale">واتساب</a>
        <a href="tel:01141965776" class="hover-scale">اتصال</a>
      </div>
    </div>
  </footer>

  <!-- إغلاق الانترو -->
  <script>
    const intro = document.getElementById('intro');
    const skip  = document.getElementById('skipIntro');
    function closeIntro(){ intro.classList.add('intro-fade'); setTimeout(()=>intro.remove(), 650); }
    const seen = sessionStorage.getItem('introSeen');
    if(seen){ closeIntro(); } else { setTimeout(closeIntro, 2800); sessionStorage.setItem('introSeen','1'); }
    skip?.addEventListener('click', closeIntro);
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>

  <!-- PptxGenJS -->
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.min.js"></script>
  <script>
    const TOPIC_IMAGES = {
      cyber:     { path: 'assets/cyber/',     count: 10 },
      marketing: { path: 'assets/marketing/', count: 10 },
      cardio:    { path: 'assets/cardio/',    count: 10 },
      general:   { path: 'assets/general/',   count: 0  }
    };

    async function urlToDataURL(url) {
      try {
        const res = await fetch(url);
        const blob = await res.blob();
        return await new Promise((resolve) => {
          const r = new FileReader();
          r.onloadend = () => resolve(r.result);
          r.readAsDataURL(blob);
        });
      } catch(e) { console.warn('Image fetch failed:', url, e); return null; }
    }

    function splitTextIntoSlides(text, desiredCount) {
      if (text.includes('///')) return text.split('///').map(s => s.trim()).filter(Boolean);
      const paragraphs = text.split(/\n{2,}/).map(p => p.trim()).filter(Boolean);
      if (!desiredCount || desiredCount < 1) {
        const chunks = []; let buf = [];
        paragraphs.forEach((p, i) => { buf.push(p); if (buf.length >= 2 || i === paragraphs.length - 1) { chunks.push(buf.join('\n\n')); buf = []; } });
        return chunks.length ? chunks : [text];
      } else {
        const per = Math.ceil(paragraphs.length / desiredCount);
        const slides = [];
        for (let i = 0; i < desiredCount; i++) {
          const start = i * per;
          const slice = paragraphs.slice(start, start + per);
          if (slice.length) slides.push(slice.join('\n\n'));
        }
        return slides.length ? slides : [text];
      }
    }

    async function addTopicImagesToSlide(slide, topicKey) {
      const topic = TOPIC_IMAGES[topicKey] || TOPIC_IMAGES.general;
      if (!topic.count) return;
      const pick = (max) => Math.max(1, Math.floor(Math.random() * max));
      const i1 = pick(topic.count), i2 = pick(topic.count);
      const u1 = topic.path + i1 + '.jpg';
      const u2 = topic.path + i2 + '.jpg';
      const [d1, d2] = await Promise.all([urlToDataURL(u1), urlToDataURL(u2)]);
      if (d1) slide.addImage({ data: d1, x: 0.5, y: 4.5, w: 4.5, h: 3.0 });
      if (d2) slide.addImage({ data: d2, x: 5.1, y: 4.5, w: 4.5, h: 3.0 });
    }

    document.getElementById('genBtn')?.addEventListener('click', async () => {
      const status = document.getElementById('genStatus');
      const txt = document.getElementById('pptText').value.trim();
      const count = parseInt(document.getElementById('slideCount').value, 10);
      const topic = document.getElementById('topic').value;
      const bg = document.getElementById('bgStyle').value;
      const langSel = document.getElementById('lang').value;

      if (!txt) { status.textContent = 'اكتب النص أولاً.'; return; }
      status.textContent = 'جاري تجهيز الملف...';

      const slidesText = splitTextIntoSlides(txt, isNaN(count) ? undefined : count);

      const pptx = new PptxGenJS();
      pptx.layout = 'LAYOUT_16x9';
      const rtl = (langSel === 'ar') || (langSel === 'auto' && /[\u0600-\u06FF]/.test(txt));
      pptx.rtlMode = rtl;

      if (bg) pptx.defineSlideMaster({ title:'MASTER_BG', background:{ path:bg }, objects:[] });

      const cover = pptx.addSlide(bg ? { masterName:'MASTER_BG' } : {});
      cover.addText('Mr Presentation | مستر بريزنتيشن', { x:0.5, y:1.0, w:9.0, h:1.0, fontSize:28, bold:true, color:'FFFFFF', align:rtl?'right':'left' });
      cover.addText('تم إنشاء العرض تلقائيًا من نص العميل', { x:0.5, y:2.0, w:9.0, h:0.6, fontSize:16, color:'DADADA', align:rtl?'right':'left' });

      for (let i=0;i<slidesText.length;i++){
        const s = pptx.addSlide(bg ? { masterName:'MASTER_BG' } : {});
        s.addText(`الشريحة ${i+1}`, { x:0.5, y:0.5, w:9.0, fontSize:22, bold:true, color:'FFFFFF', align:rtl?'right':'left' });
        s.addText(slidesText[i], { x:0.7, y:1.3, w:8.6, h:2.9, fontSize:16, color:'FFFFFF', align:rtl?'right':'left', bullet:true });
        await addTopicImagesToSlide(s, topic);
      }

      const end = pptx.addSlide(bg ? { masterName:'MASTER_BG' } : {});
      end.addText('تم — شكراً لكم', { x:0.5, y:3.5, w:9.0, h:1.0, fontSize:26, bold:true, color:'FFFFFF', align:'center' });

      const fileName = `MrPresentation_${topic}_${Date.now()}.pptx`;
      await pptx.writeFile({ fileName });
      status.textContent = 'تم إنشاء الملف وتحميله ✅';
    });
  </script>
</body>
</html>
